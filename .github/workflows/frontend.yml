name: Frontend CI/CD

on:
  push:
    branches: [ main, master ]
    paths: [ '*.html', '*.css', '*.js' ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: 🔄 Checkout
      uses: actions/checkout@v4

    - name: 🧪 Validate files
      run: |
        # Check HTML structure
        grep -q "<!doctype html>" index.html && echo "✅ HTML5 doctype found" || exit 1
        grep -q "viewport" index.html && echo "✅ Responsive meta tag found" || exit 1
        
        # Check CSS syntax
        grep -q "@media" styles.css && echo "✅ Responsive CSS found" || echo "⚠️ No media queries"
        
        # Check JS structure
        grep -q "fetch" script.js && echo "✅ API calls found" || echo "⚠️ No API integration"
        
        echo "✅ Frontend validation completed"

    - name: 🔒 Security check
      run: |
        if grep -r "password\|secret\|key" --include="*.html" --include="*.js" --include="*.css" . | grep -v "visitor-counter"; then
          echo "❌ Potential sensitive data found"
          exit 1
        fi
        echo "✅ No sensitive data found"

    - name: 📊 File sizes
      run: |
        echo "📄 Frontend assets:"
        ls -lh *.html *.css *.js 2>/dev/null || true

    - name: 🚀 Deployment Status
      run: |
        echo "✅ Frontend validation completed"
        echo "📦 Ready for Azure Storage deployment"
        echo "🔗 Target: storresume1760986821"
        echo "🌐 CDN: https://resume-endpoint-gmd7e5g9f8c6gqgs.z01.azurefd.net/"
        echo ""
        echo "💡 To deploy: Add AZURE_CREDENTIALS to GitHub Secrets"
