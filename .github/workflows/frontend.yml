name: Frontend CI/CD

on:
  push:
    branches: [ main, master ]
    paths: [ '*.html', '*.css', '*.js' ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ”„ Checkout
      uses: actions/checkout@v4

    - name: ğŸ§ª Validate files
      run: |
        # Check HTML structure
        grep -q "<!doctype html>" index.html && echo "âœ… HTML5 doctype found" || exit 1
        grep -q "viewport" index.html && echo "âœ… Responsive meta tag found" || exit 1
        
        # Check CSS syntax
        grep -q "@media" styles.css && echo "âœ… Responsive CSS found" || echo "âš ï¸ No media queries"
        
        # Check JS structure
        grep -q "fetch" script.js && echo "âœ… API calls found" || echo "âš ï¸ No API integration"
        
        echo "âœ… Frontend validation completed"

    - name: ğŸ”’ Security check
      run: |
        if grep -r "password\|secret\|key" --include="*.html" --include="*.js" --include="*.css" . | grep -v "visitor-counter"; then
          echo "âŒ Potential sensitive data found"
          exit 1
        fi
        echo "âœ… No sensitive data found"

    - name: ğŸ“Š File sizes
      run: |
        echo "ğŸ“„ Frontend assets:"
        ls -lh *.html *.css *.js 2>/dev/null || true

    - name: ğŸš€ Deployment Status
      run: |
        echo "âœ… Frontend validation completed"
        echo "ğŸ“¦ Ready for Azure Storage deployment"
        echo "ğŸ”— Target: storresume1760986821"
        echo "ğŸŒ CDN: https://resume-endpoint-gmd7e5g9f8c6gqgs.z01.azurefd.net/"
        echo ""
        echo "ğŸ’¡ To deploy: Add AZURE_CREDENTIALS to GitHub Secrets"
